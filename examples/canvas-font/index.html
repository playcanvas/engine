<!doctype html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>PlayCanvas canvas font Example</title>
        <script src="../../build/output/playcanvas-latest.js"></script>
        <style>
            body {
                margin: 0;
                padding: 0;
                overflow: hidden;
            }
        </style>
    </head>

    <body>
        <canvas id="application-canvas"></canvas>

        <!-- <script src="arabic-converter.js"></script> -->
        <script src="canvas-font.js"></script>

        <script>
            var canvas = document.getElementById('application-canvas');
            var app = new pc.Application(canvas, {
                mouse: new pc.Mouse(document.body),
                touch: new pc.TouchDevice(document.body),
                elementInput: new pc.ElementInput(canvas)
            });
            app.setCanvasFillMode(pc.FILLMODE_FILL_WINDOW);
            app.setCanvasResolution(pc.RESOLUTION_AUTO);

            // use device pixel ratio
            app.graphicsDevice.maxPixelRatio = window.devicePixelRatio;

            app.start();
        </script>

        <script>
            // Create a canvas font asset
            const size = 28;
            var cf = new CanvasFont(app, {
                fontName: "Verdana",
                fontSize: size,
                width: 128,
                height: 128
            });

            var asset = new pc.Asset("CanvasFont", "font", {});
            app.assets.add(asset);
            asset.resource = cf;
            asset.loaded = true;


            var showCanvasAtlas = false;
            if (showCanvasAtlas) {
                document.body.appendChild(cf.canvas);
                cf.canvas.style.position = 'absolute';
                cf.canvas.style.top = '0px';
            }

            // create camera
            var c = new pc.Entity();
            c.addComponent('camera', {
                clearColor: new pc.Color(44/255, 62/255, 80/255),
                farClip: 10000
            });
            c.translate(500,500,500);
            c.lookAt(0,0,0);
            app.root.addChild(c);

            var scr = new pc.Entity();
            scr.addComponent("screen", {
                screenSpace: true
            });

            // some sample text
            // var jp = "ç¥‡è¾»é£´è‘›è›¸é¯–é°¯å™Œåº–ç®¸";
            // var kailasa = "à¼„à¼…à¼ à¼à½€à¼‹à½à½²à¼‹à½‚à½´à¼‹à½„à½ºà¼ à½…à½¼à¼‹à½†à¼‹à½‡à¼‹à½‰à¼";
            // var arabic = arabicConverter.convertArabic("Ø¥Ø°.");
            // var myLongArabic = arabicConverter.convertArabic("Ø·Ù‡ÙŠØ³ ÙŠØ³ ØªØ¢Ø®Øª ØªÙ‡Ø§Øª ÙŠØ³ ÙˆØ±ÙŠØªØªØ¢Ù† ÙØ±ÙˆÙ… Ø±ÙŠØºØª ØªÙˆ Ù„Ø¢ÙØª ØªÙ‡Ø§Øª ÙŠØ³ ÙˆØ³Ø¢Ø¯").split("").reverse().join("");
            // var longArabic = arabicConverter.convertArabic("Ø§Ù† Ø¹Ø¯Ø© Ø§Ù„Ø´Ù‡ÙˆØ± Ø¹Ù†Ø¯ Ø§Ù„Ù„Ù‡ Ø§Ø«Ù†Ø§ Ø¹Ø´Ø± Ø´Ù‡Ø±Ø§ ÙÙŠ ÙƒØªØ§Ø¨ Ø§Ù„Ù„Ù‡ ÙŠÙˆÙ… Ø®Ù„Ù‚ Ø§Ù„Ø³Ù…Ø§ÙˆØ§Øª ÙˆØ§Ù„Ø§Ø±Ø¶ Ù…Ù†Ù‡Ø§ Ø§Ø±Ø¨Ø¹Ø© Ø­Ø±Ù… Ø°Ù„Ùƒ Ø§Ù„Ø¯ÙŠÙ† Ø§Ù„Ù‚ÙŠÙ… ÙÙ„Ø§ØªØ¸Ù„Ù…ÙˆØ§ ÙÙŠÙ‡Ù† Ø§Ù†ÙØ³ÙƒÙ… ÙˆÙ‚Ø§ØªÙ„ÙˆØ§ Ø§Ù„Ù…Ø´Ø±ÙƒÙŠÙ† ÙƒØ§ÙØ© ÙƒÙ…Ø§ ÙŠÙ‚Ø§ØªÙ„ÙˆÙ†ÙƒÙ… ÙƒØ§ÙØ© ÙˆØ§Ø¹Ù„Ù…ÙˆØ§ Ø§Ù† Ø§Ù„Ù„Ù‡ Ù…Ø¹ Ø§Ù„Ù…ØªÙ‚ÙŠÙ†").split("").reverse().join("");
            // var lorem = "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.";
            var emoji = "ğŸ˜ˆTesting Emoji: ğŸ˜€ğŸ˜€ğŸ˜€ ğŸ¤¢ğŸ¤¥ğŸ¤ ğŸ˜» ağŸ‘ğŸ½ğŸ‘¨â€ğŸ¤ğŸ˜a ğŸ¤”ğŸ¤” ğŸ¦€ğŸ¦€ ğŸ‘ğŸ‘»ğŸ˜—ğŸ˜ğŸ˜’ğŸ‘½ğŸ‘¾ğŸƒğŸ˜ºğŸ’©ğŸ˜ˆğŸ¤’ğŸ’‘ğŸ‘¢ğŸ­ğŸ¦ğŸ¸ğŸğŸ¦ğŸ™";

            var im = new pc.Entity();
            im.addComponent('element', {
                type: "image",
                anchor: [0.5,0.5,0.5,0.5],
                pivot: [0, 0],
                width: 500,
                height: 500,
                color: [0.3, 0.3, 0.3]
            });
            scr.addChild(im);

            cf.createTexturesForText(emoji);
            var en = new pc.Entity();
            en.addComponent("element", {
                type: "text",
                fontAsset: asset,
                fontSize: 32,
                text: emoji,
                wrapLines: true,
                autoWidth: false,
                autoHeight: false,
                width: 500,
                height: 500,
                anchor: [0,1,0,1],
                pivot: [0, 1],
                alignment: [1,1]
            });

            app.root.addChild(scr);
            im.addChild(en);
            en.translateLocal(0,-32,0)

        </script>
    </body>
</html>
